#Plotting rarefaction curves from QIIME ouput for 16S rRNA data
install.packages("tidyverse")
install.packages("vegan")
install.packages("ggplot2")
install.packages("dplyr")
install.packages("tibble")
install.packages("writexl")
install.packages("ggsci")

library(tidyverse)
library(vegan)
library(ggplot2)
library(tibble)
library(ggsci)
library(writexl)

##Rarefaction depth at 21383
##Rarefaction curve using shannon metric
#Plotting shannon values against the sequencing depth 

#Shannon data
View(shannon)

# Create a data frame for Shannon 1 data
Shannon_data <- data.frame(
  Sequencing_depth = c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2376, 2376, 2376, 2376, 2376, 2376, 2376, 2376, 2376, 2376, 4752, 4752, 4752, 4752, 4752, 4752, 4752, 4752, 4752, 4752, 7128, 7128, 7128, 7128, 7128, 7128, 7128, 7128, 7128, 7128, 9504, 9504, 9504, 9504, 9504, 9504, 9504, 9504, 9504, 9504, 11879, 11879, 11879, 11879, 11879, 11879, 11879, 11879, 11879, 11879, 14255, 14255, 14255, 14255, 14255, 14255, 14255, 14255, 14255, 14255, 16631, 16631, 16631, 16631, 16631, 16631, 16631, 16631, 16631, 16631, 19007, 19007, 19007, 19007, 19007, 19007, 19007, 19007, 19007, 19007, 21383, 21383, 21383, 21383, 21383, 21383, 21383, 21383, 21383, 21383),
  Gituamba = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6.875497782, 6.967424592, 6.93006093, 6.980978765, 7.090223525, 6.951119135, 7.057682869, 7.028523126, 6.982933625, 7.080759219, 7.36985498, 7.297421986, 7.32941735, 7.320308277, 7.307759505, 7.215548187, 7.397705155, 7.506980994, 7.315425145, 7.415064891, 7.349859662, 7.403094569, 7.433806258, 7.451026251, 7.516755838, 7.470583681, 7.578921407, 7.408404747, 7.476878963, 7.455535953, 7.490547021, 7.576192334, 7.590893122, 7.564623644, 7.565844849, 7.53866945, 7.513879674, 7.560541262, 7.58170968, 7.533636157, 7.563292109, 7.553066056, 7.586373101, 7.622051684, 7.516922215, 7.576446133, 7.636183718, 7.627860333, 7.647124447, 7.68854105, 7.664117076, 7.700794366, 7.556512194, 7.682739476, 7.644452999, 7.705069118, 7.696267756, 7.675907014, 7.690742853, 7.63510587, 7.551814263, 7.773355523, 7.692573798, 7.701301927, 7.685082713, 7.638886789, 7.674785298, 7.697669565, 7.690172762, 7.772454305, 7.709955984, 7.764068001, 7.69537746, 7.713150618, 7.684440916, 7.730380717, 7.741041156, 7.696440284, 7.644202687, 7.725069902, 7.777939595, 7.77966531, 7.792815786, 7.747687992, 7.807315107, 7.755306305, 7.727773936, 7.728328232, 7.717678152, 7.770864841),
  Mangu = c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6.876387686, 6.867735446, 6.91561101, 6.981140281, 6.826034043, 6.914331612, 6.873807795, 6.841520397, 6.762352984, 6.797890026, 7.058451239, 7.028254332, 7.08216259, 7.124346152, 7.08482942, 6.961281508, 7.033840024, 7.210372848, 7.091786749, 7.029629433, 7.209059584, 7.151699386, 7.214039644, 7.18607332, 7.193863041, 7.244197332, 7.158657321, 7.173925161, 7.234190146, 7.267414242, 7.286630697, 7.319886877, 7.307636048, 7.277351807, 7.195111576, 7.174547934, 7.27698551, 7.183193204, 7.243444493, 7.290238595, 7.294960954, 7.316211101, 7.258464364, 7.254612091, 7.284339928, 7.291189193, 7.327400727, 7.230788881, 7.256802904, 7.243727222, 7.313096524, 7.26631355, 7.349612723, 7.335302929, 7.304044189, 7.294507642, 7.272784105, 7.353544667, 7.360507553, 7.310301402, 7.327268936, 7.341493076, 7.337881107, 7.332891819, 7.339608612, 7.36529859, 7.327495931, 7.371208631, 7.352941326, 7.334880099, 7.339052519, 7.303861242, 7.361057403, 7.304397721, 7.366593852, 7.342733256, 7.34429668, 7.314025945, 7.295253921, 7.334621149, 7.347073535, 7.360437746, 7.351792798, 7.408107351, 7.355755324, 7.375867964, 7.33773866, 7.399100528, 7.405285641, 7.437432561)
)

view(Shannon_data)

# Reshape the shannon data using pivot_longer
Shannon_data_long <- pivot_longer(Shannon_data, cols = -Sequencing_depth, names_to = "Location", values_to = "Shannon")

view(Shannon_data_long)

# Plot the shannon rarefaction curve
ggplot(Shannon_data_long, aes(x = Sequencing_depth, y = Shannon, color = Location)) +
  geom_line() +
  labs(title = "Shannon Rarefaction Curve",
       x = "Sequencing Depth",
       y = "Shannon",
       color = "Location") +
  scale_fill_igv() +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())

#Faith_pd
# Create a data frmae for faith_pd data
Faith_pd_data <- data.frame(
  Sequencing_depth = c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
                       2376, 2376, 2376, 2376, 2376, 2376, 2376, 2376, 2376, 2376, 
                       4752, 4752, 4752, 4752, 4752, 4752, 4752, 4752, 4752, 4752, 
                       7128, 7128, 7128, 7128, 7128, 7128, 7128, 7128, 7128, 7128, 
                       9504, 9504, 9504, 9504, 9504, 9504, 9504, 9504, 9504, 9504, 
                       11879, 11879, 11879, 11879, 11879, 11879, 11879, 11879, 11879, 11879, 
                       14255, 14255, 14255, 14255, 14255, 14255, 14255, 14255, 14255, 14255, 
                       16631, 16631, 16631, 16631, 16631, 16631, 16631, 16631, 16631, 16631, 
                       19007, 19007, 19007, 19007, 19007, 19007, 19007, 19007, 19007, 19007, 
                       21383, 21383, 21383, 21383, 21383, 21383, 21383, 21383, 21383, 21383),
  Gituamba = c(2.420895953, 2.406127845, 2.351888566, 2.464835662, 2.335172858, 2.335172858, 2.326348705, 2.453591364, 2.431646744, 2.335172858, 
               61.77560581, 62.59865872, 62.4279577, 62.37691002, 63.24891109, 63.40124141, 62.08485639, 64.28507534, 61.84361211, 63.32441676, 
               91.60400346, 84.8549355, 83.80897589, 84.73664322, 88.9891426, 85.25835633, 89.51446728, 90.77997742, 83.46313755, 87.60448272, 
               101.6269814, 105.0555881, 106.6259679, 104.2498146, 106.6029747, 106.6773438, 107.5125, 101.845837, 106.1520462, 105.5258524, 
               119.5462438, 119.8149805, 120.2731582, 119.9639161, 118.4416413, 119.0205627, 118.7477977, 119.7351965, 117.7268428, 120.8266539, 
               130.0217783, 129.5791688, 130.3007275, 125.5634981, 128.2831489, 128.1487579, 129.6166701, 131.841484, 131.1038593, 131.9887288, 
               141.3266278, 144.38162, 141.8318335, 138.7838555, 140.1688339, 138.941602, 144.3419056, 140.4471399, 139.5771002, 140.3961858, 
               147.7897859, 150.6049841, 150.7832574, 148.3470577, 149.4742553, 148.2180502, 147.7317586, 149.8431085, 149.7251659, 148.4713089, 
               154.6372269, 161.1389464, 153.3014221, 152.4894264, 155.2338365, 155.9708288, 157.5026736, 154.2876174, 156.1226074, 156.4763709, 
               162.5533484, 162.1023571, 162.4748036, 163.6435132, 162.3043904, 161.8429316, 161.1171486, 162.3613223, 161.4183894, 165.5484971),
  Mangu = c(2.33342216, 2.347250218, 2.642027185, 2.335172858, 2.319477181, 2.642027185, 2.332992711, 2.410745331, 2.319477181, 2.297195224, 
            56.99322758, 55.86498604, 57.71815802, 56.90028396, 54.76390481, 55.43270526, 60.99451153, 56.39425102, 56.68896588, 57.47432998, 
            79.04972501, 80.65420678, 81.52369405, 79.32586905, 79.72211575, 79.30729152, 76.39393526, 79.47011623, 77.71513073, 72.9126454, 
            93.04329505, 97.64999097, 94.19156336, 91.91905839, 92.72516745, 93.11677307, 92.63673062, 94.1464771, 91.80153907, 93.05582555, 
            101.7800172, 106.3523685, 104.6738749, 104.5586314, 101.3945996, 105.75302, 103.8805627, 103.8962468, 102.794084, 105.9284464, 
            115.0602977, 112.9506696, 114.3245049, 112.1088244, 111.5477398, 110.630516, 112.232163, 115.2582601, 114.413159, 113.1450876, 
            126.5056857, 120.2039667, 118.9780782, 121.629682, 124.2967715, 119.6005135, 121.2741745, 120.6299601, 124.3539603, 122.5714216, 
            124.6301222, 127.38849, 130.7196013, 128.9914085, 125.2527689, 127.5364529, 128.9533654, 128.7043921, 130.2452855, 126.8239424, 
            132.2822804, 132.5536085, 133.8932854, 137.5738794, 134.8948206, 130.9611627, 132.7038789, 134.4766765, 133.6196623, 130.2551739, 
            137.9857873, 141.5318455, 138.4694214, 144.1978943, 136.2464951, 136.4798436, 135.2527967, 138.914761, 137.0234205, 135.3166495)
)


# Reshape the dataframe using pivot_longer
Faith_pd_reshaped_data <- pivot_longer(Faith_pd_data, 
                              cols = c(Gituamba, Mangu), 
                              names_to = "Location", 
                              values_to = "Faith_pd")
view(Faith_pd_reshaped_data)

# Plot the faith_pd  rarefaction curve
ggplot(Faith_pd_reshaped_data, aes(x = Sequencing_depth, y = Faith_pd, color = Location)) +
  geom_line() +
  labs(title = "Faith_pd Rarefaction Curve",
       x = "Sequencing Depth",
       y = "Faith_pd",
       color = "Location") + scale_fill_igv() +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())


#Observed_features data

# Define the data
Sequencing_depth <- c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2376, 2376, 2376, 2376, 2376, 2376, 2376, 2376, 2376, 2376, 4752, 4752, 4752, 4752, 4752, 4752, 4752, 4752, 4752, 4752, 7128, 7128, 7128, 7128, 7128, 7128, 7128, 7128, 7128, 7128, 9504, 9504, 9504, 9504, 9504, 9504, 9504, 9504, 9504, 9504, 11879, 11879, 11879, 11879, 11879, 11879, 11879, 11879, 11879, 11879, 14255, 14255, 14255, 14255, 14255, 14255, 14255, 14255, 14255, 14255, 16631, 16631, 16631, 16631, 16631, 16631, 16631, 16631, 16631, 16631, 19007, 19007, 19007, 19007, 19007, 19007, 19007, 19007, 19007, 19007, 21383, 21383, 21383, 21383, 21383, 21383, 21383, 21383, 21383, 21383)
Gituamba <- c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 867, 874, 865, 868, 903, 878, 890, 903, 883, 907, 1511, 1448, 1485, 1458, 1488, 1436, 1496, 1513, 1437, 1496, 1870, 1894, 1946, 1922, 1961, 1932, 2005, 1941, 1935, 1978, 2324, 2355, 2330, 2335, 2322, 2313, 2280, 2363, 2306, 2337, 2605, 2631, 2644, 2605, 2607, 2615, 2651, 2660, 2662, 2709, 2956, 2953, 2905, 2906, 2924, 2936, 2949, 2948, 2927, 2936, 3096, 3226, 3205, 3205, 3169, 3123, 3135, 3112, 3176, 3218, 3412, 3433, 3356, 3310, 3351, 3372, 3393, 3384, 3338, 3367, 3588, 3566, 3601, 3613, 3576, 3574, 3514, 3568, 3531, 3593)
Mangu <- c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 732, 734, 735, 744, 711, 737, 739, 724, 728, 711, 1157, 1160, 1151, 1175, 1137, 1113, 1127, 1177, 1130, 1122, 1477, 1448, 1445, 1426, 1413, 1474, 1416, 1432, 1460, 1434, 1688, 1712, 1688, 1663, 1636, 1682, 1701, 1668, 1669, 1690, 1857, 1854, 1855, 1861, 1849, 1839, 1864, 1854, 1815, 1844, 2045, 2015, 2006, 2016, 1983, 1996, 2019, 2029, 2022, 2020, 2121, 2144, 2126, 2170, 2110, 2129, 2156, 2156, 2162, 2143, 2256, 2229, 2252, 2248, 2278, 2234, 2276, 2249, 2234, 2205, 2331, 2345, 2340, 2400, 2326, 2348, 2341, 2345, 2332, 2359)

# Create a data frame
Observed_features_df <- data.frame(Sequencing_depth, Gituamba, Mangu)

view(Observed_features_df)

# Reshape the Observed_features data using pivot_longer
Observed_features_data_long <- pivot_longer(Observed_features_df, cols = -Sequencing_depth, names_to = "Location", values_to = "Observed_features")

View(Observed_features_data_long)

# Plot the Observed_features rarefaction curve
ggplot(Observed_features_data_long, aes(x = Sequencing_depth, y = Observed_features, color = Location)) +
  geom_line() +
  labs(title = "Observed_features Rarefaction Curve",
       x = "Sequencing Depth",
       y = "Observed_features",
       color = "Location") + scale_fill_igv() +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())

##Rarefaction depth at 225541
#Create a dataframe for shannon 2 data

# Provided data
Sequencing_depth <- c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 25061, 25061, 25061, 25061, 25061, 25061, 25061, 25061, 25061, 25061, 50121, 50121, 50121, 50121, 50121, 50121, 50121, 50121, 50121, 50121, 75181, 75181, 75181, 75181, 75181, 75181, 75181, 75181, 75181, 75181, 100241, 100241, 100241, 100241, 100241, 100241, 100241, 100241, 100241, 100241, 125301, 125301, 125301, 125301, 125301, 125301, 125301, 125301, 125301, 125301, 150361, 150361, 150361, 150361, 150361, 150361, 150361, 150361, 150361, 150361, 175421, 175421, 175421, 175421, 175421, 175421, 175421, 175421, 175421, 175421, 200481, 200481, 200481, 200481, 200481, 200481, 200481, 200481, 200481, 200481, 225541, 225541, 225541, 225541, 225541, 225541, 225541, 225541, 225541, 225541)
Gituamba <- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 7.844155785, 7.773161251, 7.771947813, 7.740380796, 7.743785635, 7.786453412, 7.793517088, 7.793232362, 7.780077974, 7.734331902, 7.87577721, 7.880728532, 7.874743418, 7.851896422, 7.824120854, 7.844236496, 7.87829773, 7.864041287, 7.892781061, 7.846150197, 7.874899597, 7.896824365, 7.874132655, 7.893115754, 7.886515323, 7.899626424, 7.901343396, 7.916755902, 7.864875433, 7.899432178, 7.906111221, 7.899705522, 7.903979072, 7.90454857, 7.910422962, 7.920186502, 7.927152375, 7.892106115, 7.923867961, 7.901098514, 7.936313572, 7.918447726, 7.934862846, 7.913622992, 7.924961621, 7.912115192, 7.942918171, 7.90244923, 7.906469475, 7.924623257, 7.927702207, 7.929939719, 7.910302585, 7.920866041, 7.926789102, 7.940144, 7.901946696, 7.932984017, 7.927859027, 7.927934784, 7.926672398, 7.934117295, 7.937244078, 7.92767138, 7.929455788, 7.921632482, 7.925037434, 7.932249211, 7.92553837, 7.915549804, 7.944732817, 7.926216436, 7.932483124, 7.946894599, 7.919272888, 7.933351639, 7.940444813, 7.940309216, 7.920417874, 7.93686672, 7.931201542, 7.935283199, 7.944863573, 7.943192815, 7.930230252, 7.925927226, 7.946102015, 7.935525903, 7.937232464, 7.931706547)
Mangu <- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 7.393494651, 7.392242504, 7.356802806, 7.386436373, 7.335207964, 7.38182297, 7.349751344, 7.391075398, 7.412430219, 7.36500828, 7.427835718, 7.441446018, 7.425896537, 7.429869024, 7.409155001, 7.434438731, 7.438615736, 7.446966603, 7.454770661, 7.422086805, 7.438774773, 7.427976594, 7.460609929, 7.415653336, 7.444911547, 7.442523922, 7.430445446, 7.452560434, 7.441757113, 7.44643448, 7.473836883, 7.445858223, 7.456446169, 7.45905879, 7.462412329, 7.456470546, 7.432966705, 7.44592352, 7.468948817, 7.451182878, 7.451918775, 7.459598855, 7.46011474, 7.44846322, 7.458774236, 7.462314866, 7.46006558, 7.456535701, 7.461489672, 7.463819928, 7.45553773, 7.454746413, 7.456871639, 7.468499673, 7.456254834, 7.46475017, 7.468329492, 7.464832029, 7.463263482, 7.463026354, 7.463441476, 7.45570886, 7.471817174, 7.46892687, 7.466735931, 7.465433225, 7.465922171, 7.465797624, 7.477340394, 7.458287368, 7.467486547, 7.46997711, 7.474101319, 7.472051517, 7.475347377, 7.470206035, 7.465777521, 7.469369527, 7.473895962, 7.468246236, 7.470390607, 7.470390607, 7.470390607, 7.470390607, 7.470390607, 7.470390607, 7.470390607, 7.470390607, 7.470390607, 7.470390607)

# Create dataframe
Shannon2_df <- data.frame(Sequencing_depth, Gituamba, Mangu)
View(Shannon2_df)

# Reshape the shannon 2 data using pivot_longer
Shannon2_data_long <- pivot_longer(Shannon2_df, cols = -Sequencing_depth, names_to = "Location", values_to = "Shannon")
View(Shannon2_data_long)

# Plot the shannon rarefaction curve
ggplot(Shannon2_data_long, aes(x = Sequencing_depth, y = Shannon, color = Location)) +
  geom_line() + labs(
       x = "Sequencing Depth",
       y = "Shannon",
       color = "Location") +
  scale_fill_igv() +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())

#Observed features 2 data
# Provided data
Sequencing_depth <- c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 25061, 25061, 25061, 25061, 25061, 25061, 25061, 25061, 25061, 25061, 50121, 50121, 50121, 50121, 50121, 50121, 50121, 50121, 50121, 50121, 75181, 75181, 75181, 75181, 75181, 75181, 75181, 75181, 75181, 75181, 100241, 100241, 100241, 100241, 100241, 100241, 100241, 100241, 100241, 100241, 125301, 125301, 125301, 125301, 125301, 125301, 125301, 125301, 125301, 125301, 150361, 150361, 150361, 150361, 150361, 150361, 150361, 150361, 150361, 150361, 175421, 175421, 175421, 175421, 175421, 175421, 175421, 175421, 175421, 175421, 200481, 200481, 200481, 200481, 200481, 200481, 200481, 200481, 200481, 200481, 225541, 225541, 225541, 225541, 225541, 225541, 225541, 225541, 225541, 225541)
Gituamba <- c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3891, 3795, 3824, 3817, 3842, 3795, 3837, 3874, 3812, 3858, 4860, 4886, 4858, 4902, 4849, 4862, 4877, 4839, 4849, 4865, 5315, 5354, 5317, 5345, 5339, 5354, 5351, 5335, 5309, 5369, 5577, 5598, 5608, 5605, 5584, 5576, 5585, 5596, 5557, 5574, 5747, 5729, 5720, 5713, 5740, 5725, 5763, 5749, 5737, 5740, 5847, 5814, 5846, 5812, 5809, 5838, 5811, 5856, 5828, 5843, 5916, 5882, 5903, 5900, 5918, 5910, 5898, 5915, 5909, 5906, 5950, 5945, 5943, 5957, 5918, 5957, 5957, 5963, 5949, 5956, 5988, 5972, 5964, 5988, 5988, 5981, 5982, 5975, 5990, 5978)
Mangu <- c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2452, 2479, 2472, 2491, 2448, 2494, 2480, 2461, 2480, 2457, 2885, 2894, 2897, 2933, 2898, 2921, 2909, 2896, 2921, 2895, 3062, 3056, 3060, 3063, 3073, 3073, 3072, 3042, 3054, 3053, 3147, 3141, 3130, 3151, 3141, 3139, 3134, 3147, 3133, 3133, 3172, 3172, 3164, 3168, 3171, 3177, 3185, 3173, 3178, 3172, 3202, 3195, 3196, 3200, 3203, 3195, 3194, 3196, 3192, 3198, 3212, 3204, 3207, 3207, 3207, 3212, 3212, 3207, 3206, 3210, 3216, 3217, 3216, 3216, 3215, 3217, 3215, 3215, 3216, 3214, 3217, 3217, 3217, 3217, 3217, 3217, 3217, 3217, 3217, 3217)


# Create dataframe
Observed_features2_df <- data.frame(Sequencing_depth, Gituamba, Mangu)

# Reshape the shannon 2 data using pivot_longer
Observed_features2_long <- pivot_longer(Observed_features2_df, cols = -Sequencing_depth, names_to = "Location", values_to = "Observed_features")

# Plot the Observed_features2 rarefaction curve
ggplot(Observed_features2_long, aes(x = Sequencing_depth, y = Observed_features, color = Location)) +
  geom_line() +
  labs(x = "Sequencing Depth",
       y = "Observed_features",
       color = "Location") + scale_fill_igv() +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())


#Faith_pd 2 data
# Provided data
Sequencing_depth <- c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 25061, 25061, 25061, 25061, 25061, 25061, 25061, 25061, 25061, 25061, 50121, 50121, 50121, 50121, 50121, 50121, 50121, 50121, 50121, 50121, 75181, 75181, 75181, 75181, 75181, 75181, 75181, 75181, 75181, 75181, 100241, 100241, 100241, 100241, 100241, 100241, 100241, 100241, 100241, 100241, 125301, 125301, 125301, 125301, 125301, 125301, 125301, 125301, 125301, 125301, 150361, 150361, 150361, 150361, 150361, 150361, 150361, 150361, 150361, 150361, 175421, 175421, 175421, 175421, 175421, 175421, 175421, 175421, 175421, 175421, 200481, 200481, 200481, 200481, 200481, 200481, 200481, 200481, 200481, 200481, 225541, 225541, 225541, 225541, 225541, 225541, 225541, 225541, 225541, 225541)
Gituamba <- c(2.335172858, 2.335172858, 2.310560704, 2.476186472, 2.339074238, 2.378231794, 2.487904149, 2.476253396, 2.465944716, 2.343360703, 173.0235823, 168.5411478, 170.8127986, 172.9525637, 173.6263337, 170.1875661, 170.6200609, 173.4965134, 170.7505466, 175.3879653, 209.3819708, 208.8952543, 209.0730289, 211.5650172, 207.884245, 206.2966331, 210.6802944, 207.1595907, 204.8498692, 205.5111027, 223.9469002, 227.0337058, 223.4264944, 226.3045149, 225.772056, 227.3529088, 228.8264644, 227.1014635, 224.6050609, 226.8221508, 236.1834524, 238.7924669, 238.1497907, 237.1163237, 235.1562033, 237.2163194, 236.1730056, 236.1811558, 233.1281556, 236.4048622, 245.2727848, 244.049621, 242.3824296, 243.1761127, 244.712196, 242.0385691, 247.1282191, 243.6180364, 242.7162594, 244.7683568, 248.4776555, 247.7349545, 249.3724168, 248.0447778, 247.105068, 248.64065, 246.4596142, 249.6413248, 248.672778, 248.6434401, 254.1462109, 249.9993113, 251.8259257, 253.590014, 254.8463426, 251.4373351, 252.0008441, 253.463223, 251.9953584, 253.1264235, 253.7889831, 253.5536346, 256.0246906, 256.0455131, 253.3489323, 255.8893506, 255.5450966, 256.3992718, 253.1798235, 255.536176, 257.9443958, 255.3260675, 256.8599002, 257.0904231, 258.6866343, 257.4843788, 258.3622734, 257.9906283, 258.1709814, 256.9201809)
Mangu <- c(2.348262337, 2.642027185, 2.335172858, 2.498896419, 2.393180391, 2.297329742, 2.584275362, 2.297329742, 2.319477181, 2.335172858, 143.2069433, 143.8052072, 145.9328958, 146.2963373, 144.2559965, 147.4016181, 146.5488618, 147.6489647, 145.2012583, 147.0959156, 167.5887509, 168.7262402, 168.4305575, 175.4045234, 168.0424422, 169.5814306, 170.538732, 167.0841064, 169.5530139, 171.293623, 178.0132259, 183.1359643, 182.345117, 182.648466, 182.8591297, 179.7264352, 178.9564837, 176.9207936, 177.7863091, 181.9891627, 188.7079712, 184.2042384, 187.6780505, 188.9350449, 187.107118, 188.5301923, 183.9762772, 188.3892283, 187.553007, 187.0395822, 190.3911172, 190.4901989, 189.5167046, 190.6243927, 190.3244162, 190.8301247, 187.4659997, 190.5396442, 191.162751, 190.1358009, 193.1164011, 192.2509802, 192.5801519, 192.7499975, 193.1084411, 192.201714, 192.2655154, 192.3504858, 188.4878277, 192.6244695, 193.8045946, 192.8586138, 193.3444204, 193.2390055, 193.1602657, 193.7222974, 193.6908009, 193.4228897, 193.0281597, 193.4642626, 194.0424772, 194.1255941, 194.0976292, 194.0177646, 193.955831, 194.1255941, 193.8856764, 193.9892886, 194.0392362, 193.9449244, 194.1255941, 194.1255941, 194.1255941, 194.1255941, 194.1255941, 194.1255941, 194.1255941, 194.1255941, 194.1255941, 194.1255941)

# Create dataframe
Faith_pd2_df<- data.frame(Sequencing_depth, Gituamba, Mangu)

# Reshape the Faith_pd 2 data using pivot_longer
Faith_pd2_long <- pivot_longer(Faith_pd2_df, cols = -Sequencing_depth, names_to = "Location", values_to = "Faith_pd")

# Plot the Faith_pd 2 rarefaction curve
ggplot(Faith_pd2_long, aes(x = Sequencing_depth, y = Faith_pd, color = Location)) +
  geom_line() +
  labs(x = "Sequencing Depth",
       y = "Faith_pd",
       color = "Location") + scale_fill_igv() +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())

##Calculate spearman Rank correlation between soil parameters and Alpha diversity metrices
##Spearman rank analysis was unsuccessful because of incompatible dimensions error
view(Gituamba_Soil_data)
View(Mangu_Soil_data)

View(Observed_features2_df)

Observed_feature2G <- subset(Observed_features2_df, select = -1)
Observed_feature3G <- subset(Observed_feature2G, select = -2)

# Ensure the observed features are a vector
observed_features_vector_G <- as.vector(Observed_feature3G$Gituamba)

# Initialize a vector to store the correlation results
correlation_results_G <- numeric(ncol(Gituamba_Soil_data))

# Loop through each soil parameter column and compute the Spearman correlation
for (i in 1:ncol(Gituamba_Soil_data)) {
  correlation_results_G[i] <- cor(observed_features_vector_G, Gituamba_Soil_data[[i]], method = "spearman")
}

##Significance test of alpha diversity metrices
#Observed_features

Ob_Gituamba <- c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3891, 3795, 3824, 3817, 3842, 3795, 3837, 3874, 3812, 3858, 4860, 4886, 4858, 4902, 4849, 4862, 4877, 4839, 4849, 4865, 5315, 5354, 5317, 5345, 5339, 5354, 5351, 5335, 5309, 5369, 5577, 5598, 5608, 5605, 5584, 5576, 5585, 5596, 5557, 5574, 5747, 5729, 5720, 5713, 5740, 5725, 5763, 5749, 5737, 5740, 5847, 5814, 5846, 5812, 5809, 5838, 5811, 5856, 5828, 5843, 5916, 5882, 5903, 5900, 5918, 5910, 5898, 5915, 5909, 5906, 5950, 5945, 5943, 5957, 5918, 5957, 5957, 5963, 5949, 5956, 5988, 5972, 5964, 5988, 5988, 5981, 5982, 5975, 5990, 5978)
Ob_Mangu <- c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2452, 2479, 2472, 2491, 2448, 2494, 2480, 2461, 2480, 2457, 2885, 2894, 2897, 2933, 2898, 2921, 2909, 2896, 2921, 2895, 3062, 3056, 3060, 3063, 3073, 3073, 3072, 3042, 3054, 3053, 3147, 3141, 3130, 3151, 3141, 3139, 3134, 3147, 3133, 3133, 3172, 3172, 3164, 3168, 3171, 3177, 3185, 3173, 3178, 3172, 3202, 3195, 3196, 3200, 3203, 3195, 3194, 3196, 3192, 3198, 3212, 3204, 3207, 3207, 3207, 3212, 3212, 3207, 3206, 3210, 3216, 3217, 3216, 3216, 3215, 3217, 3215, 3215, 3216, 3214, 3217, 3217, 3217, 3217, 3217, 3217, 3217, 3217, 3217, 3217)

#Perform a two sample two-sided t-test

t.test(Ob_Gituamba, Ob_Mangu, alternative = "two.sided", var.equal = FALSE)

#Shannon 

Sh_Gituamba <- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 7.844155785, 7.773161251, 7.771947813, 7.740380796, 7.743785635, 7.786453412, 7.793517088, 7.793232362, 7.780077974, 7.734331902, 7.87577721, 7.880728532, 7.874743418, 7.851896422, 7.824120854, 7.844236496, 7.87829773, 7.864041287, 7.892781061, 7.846150197, 7.874899597, 7.896824365, 7.874132655, 7.893115754, 7.886515323, 7.899626424, 7.901343396, 7.916755902, 7.864875433, 7.899432178, 7.906111221, 7.899705522, 7.903979072, 7.90454857, 7.910422962, 7.920186502, 7.927152375, 7.892106115, 7.923867961, 7.901098514, 7.936313572, 7.918447726, 7.934862846, 7.913622992, 7.924961621, 7.912115192, 7.942918171, 7.90244923, 7.906469475, 7.924623257, 7.927702207, 7.929939719, 7.910302585, 7.920866041, 7.926789102, 7.940144, 7.901946696, 7.932984017, 7.927859027, 7.927934784, 7.926672398, 7.934117295, 7.937244078, 7.92767138, 7.929455788, 7.921632482, 7.925037434, 7.932249211, 7.92553837, 7.915549804, 7.944732817, 7.926216436, 7.932483124, 7.946894599, 7.919272888, 7.933351639, 7.940444813, 7.940309216, 7.920417874, 7.93686672, 7.931201542, 7.935283199, 7.944863573, 7.943192815, 7.930230252, 7.925927226, 7.946102015, 7.935525903, 7.937232464, 7.931706547)
Sh_Mangu <- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 7.393494651, 7.392242504, 7.356802806, 7.386436373, 7.335207964, 7.38182297, 7.349751344, 7.391075398, 7.412430219, 7.36500828, 7.427835718, 7.441446018, 7.425896537, 7.429869024, 7.409155001, 7.434438731, 7.438615736, 7.446966603, 7.454770661, 7.422086805, 7.438774773, 7.427976594, 7.460609929, 7.415653336, 7.444911547, 7.442523922, 7.430445446, 7.452560434, 7.441757113, 7.44643448, 7.473836883, 7.445858223, 7.456446169, 7.45905879, 7.462412329, 7.456470546, 7.432966705, 7.44592352, 7.468948817, 7.451182878, 7.451918775, 7.459598855, 7.46011474, 7.44846322, 7.458774236, 7.462314866, 7.46006558, 7.456535701, 7.461489672, 7.463819928, 7.45553773, 7.454746413, 7.456871639, 7.468499673, 7.456254834, 7.46475017, 7.468329492, 7.464832029, 7.463263482, 7.463026354, 7.463441476, 7.45570886, 7.471817174, 7.46892687, 7.466735931, 7.465433225, 7.465922171, 7.465797624, 7.477340394, 7.458287368, 7.467486547, 7.46997711, 7.474101319, 7.472051517, 7.475347377, 7.470206035, 7.465777521, 7.469369527, 7.473895962, 7.468246236, 7.470390607, 7.470390607, 7.470390607, 7.470390607, 7.470390607, 7.470390607, 7.470390607, 7.470390607, 7.470390607, 7.470390607)

#Perform a two sample two-sided t-test

t.test(Sh_Gituamba, Sh_Mangu, alternative = "two.sided", var.equal = FALSE)

##Faith_pd

Pd_Gituamba <- c(2.335172858, 2.335172858, 2.310560704, 2.476186472, 2.339074238, 2.378231794, 2.487904149, 2.476253396, 2.465944716, 2.343360703, 173.0235823, 168.5411478, 170.8127986, 172.9525637, 173.6263337, 170.1875661, 170.6200609, 173.4965134, 170.7505466, 175.3879653, 209.3819708, 208.8952543, 209.0730289, 211.5650172, 207.884245, 206.2966331, 210.6802944, 207.1595907, 204.8498692, 205.5111027, 223.9469002, 227.0337058, 223.4264944, 226.3045149, 225.772056, 227.3529088, 228.8264644, 227.1014635, 224.6050609, 226.8221508, 236.1834524, 238.7924669, 238.1497907, 237.1163237, 235.1562033, 237.2163194, 236.1730056, 236.1811558, 233.1281556, 236.4048622, 245.2727848, 244.049621, 242.3824296, 243.1761127, 244.712196, 242.0385691, 247.1282191, 243.6180364, 242.7162594, 244.7683568, 248.4776555, 247.7349545, 249.3724168, 248.0447778, 247.105068, 248.64065, 246.4596142, 249.6413248, 248.672778, 248.6434401, 254.1462109, 249.9993113, 251.8259257, 253.590014, 254.8463426, 251.4373351, 252.0008441, 253.463223, 251.9953584, 253.1264235, 253.7889831, 253.5536346, 256.0246906, 256.0455131, 253.3489323, 255.8893506, 255.5450966, 256.3992718, 253.1798235, 255.536176, 257.9443958, 255.3260675, 256.8599002, 257.0904231, 258.6866343, 257.4843788, 258.3622734, 257.9906283, 258.1709814, 256.9201809)
Pd_Mangu <- c(2.348262337, 2.642027185, 2.335172858, 2.498896419, 2.393180391, 2.297329742, 2.584275362, 2.297329742, 2.319477181, 2.335172858, 143.2069433, 143.8052072, 145.9328958, 146.2963373, 144.2559965, 147.4016181, 146.5488618, 147.6489647, 145.2012583, 147.0959156, 167.5887509, 168.7262402, 168.4305575, 175.4045234, 168.0424422, 169.5814306, 170.538732, 167.0841064, 169.5530139, 171.293623, 178.0132259, 183.1359643, 182.345117, 182.648466, 182.8591297, 179.7264352, 178.9564837, 176.9207936, 177.7863091, 181.9891627, 188.7079712, 184.2042384, 187.6780505, 188.9350449, 187.107118, 188.5301923, 183.9762772, 188.3892283, 187.553007, 187.0395822, 190.3911172, 190.4901989, 189.5167046, 190.6243927, 190.3244162, 190.8301247, 187.4659997, 190.5396442, 191.162751, 190.1358009, 193.1164011, 192.2509802, 192.5801519, 192.7499975, 193.1084411, 192.201714, 192.2655154, 192.3504858, 188.4878277, 192.6244695, 193.8045946, 192.8586138, 193.3444204, 193.2390055, 193.1602657, 193.7222974, 193.6908009, 193.4228897, 193.0281597, 193.4642626, 194.0424772, 194.1255941, 194.0976292, 194.0177646, 193.955831, 194.1255941, 193.8856764, 193.9892886, 194.0392362, 193.9449244, 194.1255941, 194.1255941, 194.1255941, 194.1255941, 194.1255941, 194.1255941, 194.1255941, 194.1255941, 194.1255941, 194.1255941)

#Perform a two sample two-sided t-test

t.test(Pd_Gituamba, Pd_Mangu, alternative = "two.sided", var.equal = FALSE)
